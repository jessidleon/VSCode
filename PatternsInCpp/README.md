This code is based on book from Dmitry Nesteruk
